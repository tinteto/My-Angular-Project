<div class="container">
<div class="recipeDetails">
   
<!--!READ ONLY MODE-->
 <!-- HEADER IMAGE -->
<ng-container *ngIf="!showEditRecipeForm">
    <!-- MAIN CONTENT -->
  <div class="recipeContent">
     <main class="main-content">
    <figure>
      <img class="header-img" src="{{recipe.img}}" alt="RecipeImg"> 
    </figure>
      <p>Created on: {{recipe._createdOn | momentPipe }}</p>
      <h1 class="content-title">{{recipe.name }}</h1> <!--name of the recipe-->
      <p>
        An easy and quick dish, perfect for any meal. This classic recipe combines easy to access products prepared to perfection, optionally accompanied by your choice of wine, or other suitable beverage. Enjoy!
      </p>
      <!-- INGREDIENTS -->
      <article class="ingredients">
        <h2>Ingredients</h2>
        <ul > <!-- *ngFor="let ingredient of recipe.ingredients"-->
          <li>
            <p> {{ recipe.ingredients}} </p>
          </li>
        </ul>
      </article>
      <hr>
      <!-- INSTRUCTIONS -->
      <article class="instructions">
        <h2>Instructions</h2>
        <ul> <!-- *ngFor="let step of recipe.steps"-->
          <li>
            <div>
              <p>{{ recipe.steps }}</p>
            </div>
          </li>
        </ul>
      </article>
      <hr>
     </main>


    <!--BUTTONS AND COMMENTS-->
     <div class="buttonsAndcomments">
     <!-- BUTTONS -->
    <button *ngIf="isLoggedIn && isOwner(recipe)"
    class="editRecipe" (click)="onToggleEdit()" style="background-color: #FF6B6D">Edit Recipe</button>
    <button *ngIf="isLoggedIn && isOwner(recipe)"
    class="deleteRecipe" (click)="onDeleteRecipe()" style="background-color: #FF6B6D">Delete Recipe</button>
    <button *ngIf="isLoggedIn"
    class="commentRecipe" (click)="onToggleComment()" style="background-color: #04AA6D">Show Add Comment Section</button> <!--TODO да се скрива-->
  


    <!--COMMENTS FORM-->
    <ng-container *ngIf="showCommentSection">
     <div class="writeComment">
     <div class="addComment">
      <form class="commentForm" #form="ngForm" (ngSubmit)="addComment(form)">
        <textarea type="text" name="comment" id="comment" cols="15" rows="5" ngModel #textAreaComment="ngModel" required></textarea>
        <button class="commentRecipe">Add Comment</button>
        <!--TODO validations and button css-->
      </form>
      </div>
      </div>
    </ng-container>

    <!--COMMENTS-->
    <div class="commentSection" >
    <div class="title">
      <h4>Comments for {{recipe.name}}:</h4>
    </div>
    <div class="userComments" *ngFor="let comment of comments">
    <header>
      <p>{{recipe._ownerId}} commented:</p> <!--TODO-->
    </header>
    <div class="commentContent">
      <p>{{comment.content}}</p>
    </div>
</div>
</div>

  
     </div>
  </div>
</ng-container>










  <!--!EDIT MODE-->
<div class="editContainer">
  <ng-container *ngIf="showEditRecipeForm">
    <form [formGroup]="form" (ngSubmit)="updateRecipeHandler()">
      
      <div>
        <p>Recipe Name:</p>
        <input type="text" name="name" id="name" [value]="recipeDetails.name" formControlName="name">
      </div>
      <!--recipe name validations-->
      <ng-container *ngIf="form.get('name')?.touched">
        <p *ngIf="form.get('name')?.errors?.['required']" style="color: rgb(255, 51, 0)">Recipe name is required!</p>
        <p *ngIf="form.get('name')?.errors?.['minlength']" style="color: rgb(255, 51, 0)">Recipe name should be at least 3 characters long!</p>
      </ng-container>


      
      <div class="img">
        <label>Image: <input type="text" name="img" placeholder="Image URL" [value]="recipeDetails.img" formControlName="img"></label>
      </div>
     <!-- <ng-container *ngIf="form.get('img')?.touched">
        <p *ngIf="form.get('img')?.errors?.['required']" style="color: rgb(255, 51, 0)">Image is required!</p>
      </ng-container> -->


      <div>
        <p>Ingredients:</p>
        <textarea type="text" name="ingredients" id="ingredients" rows="5" placeholder="Enter all ingredients required..." [value]="recipeDetails.ingredients" formControlName="ingredients" ></textarea>
      </div>
       <!-- ingredients validations-->
      <ng-container *ngIf="form.get('ingredients')?.touched">
        <p *ngIf="form.get('ingredients')?.errors?.['required']" style="color: rgb(255, 51, 0)">Enter all ingredients required!</p>
        <p *ngIf="form.get('ingredients')?.errors?.['minlength']" style="color: rgb(255, 51, 0)">Ingredients text should be at least 10 characters long!</p>
      </ng-container>
     

      <div>
        <p>Instructions</p>
        <textarea type="text" name="steps" id="steps" rows="5" placeholder="Enter all steps that should be followed..." [value]="recipeDetails.steps" formControlName="steps" ></textarea>
      </div>
      <!--steps validations-->
      <ng-container *ngIf="form.get('steps')?.touched">
        <p *ngIf="form.get('steps')?.errors?.['required']" style="color: rgb(255, 51, 0)">Enter all instructions that should be followed!</p>
        <p *ngIf="form.get('steps')?.errors?.['minlength']" style="color: rgb(255, 51, 0)">Instructions text should be at least 10 characters long!</p>
      </ng-container>

      <!--ACTIONS-->
      <button type="submit" class="saveChanges" [disabled]="form.invalid" [style]="{backgroundColor: form.invalid ? '#FF6B6D' : '#04AA6D'}">Save Changes</button>
      <button class="cancel" (click)="onCancelEditRecipe($event)" style="background-color: #FF6B6D">Cancel</button>
    
    </form>
  </ng-container>
</div>

</div>
</div>



